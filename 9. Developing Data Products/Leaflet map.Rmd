---
title: "Map created with Leaflet"
author: "Alexey Maranda"
date: '23 February 2017 ã '
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(leaflet)
```

### Data Source

The data set give the locations of 1000 seismic events of MB > 4.0. The events occurred in a cube near Fiji since 1964.

```{r}
data(quakes)

head(quakes)

str(quakes)
```

### Explore histogram of mag and depth 


```{r  echo=FALSE}
hist(quakes$mag) 
```

```{r  echo=FALSE}
hist(quakes$depth)
```

### Data manipulation

Set groups for Makers color and radius:  
```{r}
# set color and radius for markers
quakes$mag_color <- as.factor(with(quakes , ifelse(mag>=4.0&mag<4.5 ,"Green" ,
                                         ifelse (mag>=4.5&mag<5.0 ,"Yellow" , "Red"))))

quakes$radius <- with(quakes , ifelse(depth>=0&depth<200 ,12 ,
                                                   ifelse (depth>=200&depth<500 ,6 , 2)))
```

### Draw Leaflet map with Circle Markers
On the map the Green color - is for mag between 4.0 and 4.5 , Yellow color - for mag between 4.5 and 5.0 and Red color - when it's more 5.0.
Also the radius of Makers is less when earthquake was deeper.

```{r}
leaflet(quakes) %>% addTiles() %>% addCircleMarkers(
    radius = quakes$radius,
    color = quakes$mag_color,
    stroke = FALSE, fillOpacity = 0.6
)
```

#### The End :)
